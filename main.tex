\documentclass[12pt]{article}

\usepackage{amsfonts}
\usepackage{amsthm}
\usepackage{amsmath}
\usepackage{mathtools}

\newcommand{\floor}[1]{\lfloor #1 \rfloor}
\newcommand{\FF}{\mathbb{F}}
\newcommand{\ZZ}{\mathbb{Z}}
\newcommand{\LL}{\mathcal{L}}

\newtheorem{question}{Question}
\newtheorem{lemma}{Lemma}
\newtheorem{remark}{Remark}
\newtheorem{definition}{Definition}




\title{Thoughts about polynomial case}
\author{ Sasha }



\begin{document}

\maketitle

\section{Lattice computation for polynomials}
Let us set parameters a prime power $q$ and integers $k$, $d$ and $n$. Let $\FF_{q}[x]$ be polynomial ring over a field  $\FF_{q}$. We take a set of $k$ irreducible polynomials $c_{j}(x) \in \FF_{q}[x]$, $j =1, ...,k$ of degree $d$. According to the analogue of the prime number theorem for polynomials $k$ must not be greater than $\frac{q^d}{d}$.

Define $c(x) \coloneqq \prod_{j = 1}^{k} c_{j}(x)$. We are going to work in the multiplicative group of the quotient ring of  $\FF_{q}[x]$ with respect to $c(x)$.
Chinese Remainder Theorem helps to determine the structure of $\big(\FF_{q}[x]/c(x)\big)^{*}$:
\[
    \big(\FF_{q}[x]/c(x)\big)^{*} \sim \prod_{i=1}^{k}\big(\FF_{q}[x]/c_{i}(x)\big)^{*} \sim \prod_{i=1}^{k}\FF_{q^{d}}^*
\]
Multiplicative group of a field is cyclic, therefore, we can consider discrete logarithms in every component of the product to find a lattice basis.

Consider a vector $a = (\alpha_{1}, ... , \alpha_{n}) \in \FF_{q}^{n}$ where $\alpha_{i}$s are pairwise different. Since polynomials $c_{j}(\cdot)$ are irreducible over $\FF_{q}$ neither of $\alpha_{i}$ can be their root. So for all $\alpha_{i}$ we also have: $c(\alpha_{i}) \neq 0$.

Now consider a group morphism:
\[
    \psi : \ZZ^{n} \rightarrow \big(\FF_{q}[x]/c(x)\big)^{*}
\]
\[
    (u_{1}, ..., u_{n}) \mapsto \prod_{i=1}^{n}(x - \alpha_{i})^{u_{i}} \pmod{c(x)}
\]

Lattice is defined as the kernel of the morphism:
\[
    \LL = \ker \psi = \{(u_{1}, ..., u_{n}) \in \ZZ^{n} | \prod_{i=1}^{n}(x - \alpha_{i})^{u_{i}} \equiv 1 \pmod{c(x)}\}
\]
Appying CRT gives us the following equivalence
\[
    \LL = \ker \psi = \{(u_{1}, ..., u_{n}) \in \ZZ^{n} |  \forall 1 \leq j \leq k: \prod_{i=1}^{n}(x - \alpha_{i})^{u_{i}} \equiv 1 \pmod{c_{j}(x)}\}
\]
Supposing we know $\beta_{j}$ a generator of $\big(\FF_{q}[x]/c_{j}(x)\big)^{*}$ for every $j$ we get another representation:
\[
    \LL = \{(u_{1}, ..., u_{n}) \in \ZZ^{n} | \forall 1 \leq j \leq k: \sum_{i=1}^{n}u_{i}log_{\beta_{j}}(x - \alpha_{i}) \equiv 0 \pmod{q^{d} -1}\}
\]
What might be confusing is that each $\log_{\beta_{j}}$ has a different input domain. For every $j$:  $\log_{\beta_{j}}$ acts from $\big(\FF_{q}[x]/c_{j}(x)\big)^{*}$ into $(\ZZ/(q^{d} - 1)\ZZ)$.

We obtained a parity check representation of $\LL$.
To calculate a basis of $\LL$ we can follow simplified version of the algorithm for integers. We obtain dual basis by scaling parity check matrix and concatenating it with $I_{n}$. Then we remove linear dependencies and finally obtain primal basis from the dual.

\section{Building blocks}
\subsection{Factorization by trial division}
Input: A polynomial $g$ such that $deg(g) \leq m$ whose roots are among $\alpha_1, \dots , \alpha_n \in \mathbb{F}_q$\\
Output: $e_1, \dots , e_n$ s.t. $g = \prod_{i = 1}^{n}(x - \alpha_i)^{e_i}$\\
There's only $n$ possible roots, one trial division takes $O(m)$ time and the number of factors is bounded by $m$. So overall complexity is $O(m^2n)$.


\subsection{Rational function reconstruction}
I found here: http://www.cecm.sfu.ca/~mmonagan/theses/sara.pdf and then here: http://www.cecm.sfu.ca/~mmonagan/papers/fastRFR.pdf
an algorithm which they call Wang's algorithm for rational function reconstruction.\\
Goal: Given $g,f$ find $n, d \in \mathbb{F}[x]$ that $deg(n) \leq N$, $deg(d) \leq D$, $N + D < deg(f)$ and $\frac{n}{d} = g \pmod{f}$\\
Algorithm:(function $lc()$ outputs the leading coefficient)
\begin{enumerate}
	\item Set $N = \floor{\frac{deg(f)}{2}}$ $D = deg(f) - N - 1$\\
			$r_0 = f$  $t_0 = 0$\\
			$r_1 = g$  $t_1 = 1$\\
	\item While $deg(r_1) > N$ do\\
			$q = r_0 // r_1$\\
			$(r_0, r_1) = (r_1, r_0 - qr_1)$\\
			$(t_0, t_1) = (t_1, t_0 - qt_1)$\\
	\item if $GCD(r_1, t_1) \neq 1$:\\
			return FAIL\\
		  else:\\
			return $(\frac{r_1}{lc(t_1)}, \frac{t_1}{lc(t_1)})$
\end{enumerate}
\begin{lemma}
Let $\mathbb{F}$ be a field, $f, g, r, s, t \in \mathbb{F}[x]$ with $r = sf + tg$, $t \neq 0$, $deg(f) > 0$, and $deg(r) + deg(t) <deg(f)$.
Suppose $r_i, s_i, t_i$ for $0 \leq i \leq l + 1$ be the elements of the ith iteration in the Extended Euclidean Algorithm for $f$ and $g$ (e.i. $r_i = s_if + t_ig$). \\
Then there exists a nonzero element $\alpha \in \mathbb{F}[x]$ such that $r = \alpha r_j$, $s = \alpha s_j$, $t = \alpha t_j$, where $deg(r_j) \leq deg(r) < deg(r_{j-1})$
\end{lemma}
\begin{proof}
http://www.cecm.sfu.ca/~mmonagan/theses/sara.pdf \\(Lemma 3.2 page 35)
\end{proof}

So if the solution exists it must be one of the pairs $(r_i, t_i)$ of the EEA.

\begin{question}
Why do we give up if the first gcd check fails instead of coming back to the while loop?
\end{question}
{\bf LEO: I do not know those algorithms, so I don't know... How about trying them on many random instance, and see if your variation also works ?}


Note $n = deg(f)$.
Complexity of the algorithm is one of the Extended Euclidean Algorithm $O(n^2)$. Or we can maybe use Fast Extended Euclidean Algorithm whose complexity is $O(M(n)log(n))$ where $M(n)$ is the complexity of multiplication of polynomials, so $O(nlog^2(n))$
\begin{question}
Check if we can actually use FEEA.
\end{question}
\begin{remark}
In the paper they also give an algorithm for the case where the bounds for degrees are not set in advance, but it works only with high probability(should I look into it in more detail?)
\end{remark}
\subsection{Computing logs}
\begin{question}
In LLXY17 what do they mean when using the same generator $\beta$ for every $c_j(x)$? In reality we would need to find $t$ generators one for every "coordinate"?
\end{question}
{\bf LEO: Hum, maybe most elements of $F_q[X]/(c_j(X))$ are generators, in which case it is possible that a single $\beta \in F_q[X]$ of small degree is a generator of each of them ?}

To construct the lattice we need to compute the following:
$\forall 1 \leq i,j \leq n :$ $log_{\beta_j}(x - \alpha_i) \pmod{c_j(x)}$. The order of multiplicative group is $q^{d_0} - 1$ which might not be a smooth integer so we cannot use Pohlig-Hellman+Pollard pho. Maybe we can just take small parameters $q, d_0$: $q=constant$ and $d_0 = \theta(\sqrt n)$? If not we would need to use some smart DL algorithm that runs in quasi-polynomial time...

{\bf LEO: I guess all you need is $q^{d_0} = n^{O(1)}$ ($poly(n)$), for example $d_0 = constant$ and $q=n^{O(1)}$ does works, so does $q=constant$ and $d_0 = O(\log n)$.}

\section{Decoding radius}

\subsection{Only positive discrete error}
Suppose we receive $t = u + e$ where $u \in \mathcal{L}$, $\|e\|_1 \leq r_1$ and $\forall i: e_i \in \mathbb{N}$. Then we can compute
\[
\prod_{i = 1}^{n}(x - \alpha_i)^{t_i} = \prod_{i = 1}^{n}(x - \alpha_i)^{u_i}\prod_{i = 1}^{n}(x - \alpha_i)^{e_i} \pmod{c(x)}
\]
If $\|e\|_1 = \sum_{i =1}^{n} e_i \leq deg(c) = d_0t$ the operation above will give us exactly the polynomial $\prod_{i = 1}^{n}(x - \alpha_i)^{e_i}$. Then we can recover $e_i$, $1 \leq i \leq n$ from the factorization.\\
So $r_1 = d_0t$.
\subsection{Arbitrary discrete error}
Now we have $\forall i: e_i \in \mathbb{Z}$. Then
\[
\prod_{i = 1}^{n}(x - \alpha_i)^{t_i} \pmod{c(x)} = \prod_{i = 1}^{n}(x - \alpha_i)^{e_i} = \frac{\prod_{i \in I}(x - \alpha_i)^{e_i}}{\prod_{j \in J}(x - \alpha_j)^{-e_j}}
\]
\begin{lemma}
Given $g,c$ where $deg(c) = d_0t$ we can recover $n, d \in \mathbb{F}[x]$ that $deg(n) \leq \floor{\frac{d_0t}{2}}$, $deg(d) \leq \floor{\frac{d_0t}{2}}$ and $\frac{n}{d} = g \pmod{c}$ in polynomial time.
\end{lemma}
So we can decode every message for which $\|e\|_1 = \sum_{i =1}^{n} |e_i| \leq \floor{\frac{d_0t}{2}}$

\subsection{Continuous error and $l_2$ norm}
Directly follows from \cite{[DP19]}. $r_2 = \frac{\floor{\frac{d_0t}{2}}}{\sqrt{n} det(\mathcal{L})^{1/n}}$ where $det(\mathcal{L}) = \Phi(c(x)) = (q^{d_0} - 1)^{t}$.
\[
r_2 = \frac{\floor{\frac{d_0t}{2}}}{\sqrt{n} (q^{d_0} - 1)^{t/n}}
\]
\begin{question}
What should be the values of $d_0$ and $t$? It must be $\sqrt{n} < d_0t < n^{1+\epsilon}$(otherwise the tends to 0). If $d_0t = n$ it is very close to Minkowski's bound. It looks too good to be true?
\end{question}
{\bf LEO: I am a bit lost: there are several constraints on the parameters, and you need to instantiate them all verifying all the constraints to conclude. At the moment you've chosen $d_0t$ but not $d_0$ and $t$ themselves so I am unsure you can conclude...}

\bibliographystyle{ieeetr}
\bibliography{main}
\end{document}
